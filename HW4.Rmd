---
title: "Music Physiological Response Analysis"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: show
    theme: cosmo
date: "2025-02-28"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.width = 10, 
  fig.height = 6,
  out.width = "100%"
)
```

## 1. Load Packages and Set Theme

```{r packages}
# Load necessary packages

library(tidyverse)

library(lme4)      # For mixed linear models
library(ggExtra)

```


## Load Data
 Original File: https://www.kaggle.com/datasets/thedevastator/uncover-global-trends-in-mental-health-disorder/data
```{r}
url <- "https://raw.githubusercontent.com/Elias-desig/Stats-HW4/refs/heads/main/Mental_health_data.csv"
df <- read.csv(url, fileEncoding = "UTF-8")
```


## Cleaning Data

```{r}
df$Code <- NULL
df <- df %>% rename(Schizophrenia = Schizophrenia....,
                    Bipolar.disorder = Bipolar.disorder....,
                    Eating.disorders = Eating.disorders....,
                    Anxiety.disorders = Anxiety.disorders....,
                    Drug.use.disorders = Drug.use.disorders....,
                    Depression = Depression....,
                    Alcohol.use.disorders = Alcohol.use.disorders....)

# Only the first 6,468 rows contain data for mental health disorder prevalence in percentages 
df <- df[1:6468,]
# Convert data that should be numeric to numeric
df$Schizophrenia <- as.numeric(df$Schizophrenia)
df$Bipolar.disorder <- as.numeric(df$Bipolar.disorder)
df$Eating.disorders <- as.numeric(df$Eating.disorders)
df$Year <- as.numeric(df$Year)


summary(df)


```

## Plot data

```{r}

long_df <- pivot_longer(df, cols = c(Schizophrenia, Bipolar.disorder, Eating.disorders, Anxiety.disorders, Drug.use.disorders, Depression, Alcohol.use.disorders), names_to = 'disorder', values_to = 'prevalence')

long_df %>% ggplot(aes(x = prevalence, fill = disorder)) + 
  geom_histogram() + 
  facet_wrap(vars(disorder), scale="free")

```

```{r}
# UnnÃ¶tiger Plot
df %>% ggplot(aes(x=Year, y=Schizophrenia)) +
      geom_point() +
      geom_smooth(method = "lm")  

  

```


## Hypothesis 1

Schizophrenia prevalence is not correlated with other mental disorders

```{r}
model_1 <- lmer(Schizophrenia ~ Depression + Eating.disorders + Bipolar.disorder + Anxiety.disorders + Drug.use.disorders + Alcohol.use.disorders + (1|Entity), data = df)
summary(model_1)
```

##Hypothesis 2

Depression is determined by the environment, ie the country/region a person lives in in this case.

```{r}
model_2 <- lmer(Depression ~ Entity + (1|Year), data = df)
summary(model_2)
```


## Hypothesis 3:
Mental health is getting worse

```{r}
model_3 <- lmer(prevalence ~ Year + (1|disorder) + (1|Entity), data = long_df)
summary(model_3)
```
