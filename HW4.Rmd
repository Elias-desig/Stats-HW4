---
title: "HW4"
output: html_document
date: "2025-02-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
loading packages
```{r}
library(tidyverse)
library(lme4)
```
loading Dataset
link: https://www.kaggle.com/datasets/erikhambardzumyan/pubs?select=armenian_pubs.csv
```{r}
df <- read.csv("C:/Users/Elias/Downloads/armenium_pubs_dataset/armenian_pubs.csv", header = TRUE, sep = ",")
df <- as_tibble(df)
head(df)    # Show the first few rows
str(df)     # Show the structure of the dataframe
summary(df) # Get summary statistics

```
Preprocessing
```{r}
df$Timestamp <- NULL
df <-na.omit(df)

#Correct spelling / Group duplicate Pub Names
unique(df$Fav_Pub)

df$Fav_Pub <- dplyr::case_when(
    df$Fav_Pub %in% c("VOID", "Void") ~ "VOID",
    df$Fav_Pub %in% c("Venue", "Venue ") ~ "Venue",
    df$Fav_Pub %in% c("I have none", "Do not have one") ~ "No Fav",
    df$Fav_Pub %in% c("DAS ", "DAS") ~ "DAS",
    df$Fav_Pub %in% c("Tom Collins ", "Tom collins", "Tom Collins") ~ "Tom Collins",
    df$Fav_Pub %in% c("The beatles", "Beatles") ~ "The Beatles",
    df$Fav_Pub %in% c("Liberty ", "Liberty") ~ "Liberty",
    df$Fav_Pub %in% c("37 pub", "Pub 37") ~ "Pub 37",
    df$Fav_Pub %in% c("Bulldog ", "BullDog") ~ "BullDog",
    TRUE ~ df$Fav_Pub  # Keep all other values unchanged
)


```
Plotting Data

```{r}
colnames(df)

df <- df %>% rename(
  Age = Age.,
  Gender = Gender.,
  Income = Income.
  
)
df %>% ggplot(aes(x = Age, y = WTS)) + 
        geom_point()


```
Plot 2

```{r}
df %>% ggplot(aes(x = Income, y = WTS)) + 
        geom_point()
```

```{r}
# Bar chart for favorite WTS for different bars
df %>% 
  group_by(Fav_Pub) %>% 
  summarise(mean_WTS = mean(WTS, na.rm = TRUE)) %>%  # Calculate mean WTS
  ggplot(aes(x = reorder(Fav_Pub, mean_WTS), y = mean_WTS, fill = mean_WTS)) + 
  geom_col() + 
  coord_flip() +  
  scale_fill_viridis_c() +  # Better color scale for numeric values
  theme_minimal() +
  theme(axis.text.y = element_text(size = 8, vjust = 0.5)) +  # Adjust label size
  labs(x = "Favorite Pub", y = "Mean WTS", title = "Mean Willingness to Spend for Different Pubs")

```

```{r}
df$Gender <- factor(df$Gender, levels = c("Male", "Female", "Other")) # Adjust levels as needed
# Bar chart for favorite bar by gender
df %>% 
  ggplot(aes(x = Fav_Pub, fill = Gender)) + 
  geom_bar(position = "dodge") + 
  coord_flip() +  
  theme_minimal() +
  theme(axis.text.y = element_text(size = 6, vjust = 0.5)) +  # Increase font size
  labs(x = "Favorite Pub", y = "Count", title = "Favorite Pubs by Gender")


```
Plot ...
```{r}
df %>% ggplot(aes(x = Age, y = WTS)) + 
        geom_point()
```

Hypothesis 1:
Willingness to spend is determined by Income
```{r}

```

Hypothesis 2
```{r}

```

